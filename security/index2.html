<html>
    <head>
        <style type="text/css">
            * {
                padding: 0;
                margin: 0;
                box-sizing: border-box;
            }
            div#navigationBar {
                display: flex;
                flex-direction: row;
                background-color: black;
                height: 9%;
                width: 100%;
                align-items: center;
            }
            div#title {
                color: white;
                font-size: 26px;
                margin: 0.5em;
            }
            div#dialogBox {
                position: fixed;
                height: 100%;
                background-color: black;
                width: 20vw;
                display: none;
            }
            div#dialogBoxNavBar {
                display: flex;
                height: 2em;
                padding: 0.5em;
                justify-content: right;
                align-items: center;
            }
            div#mainContentContainer {
                display: flex;
                justify-content: right;
                min-height: 91%;
                font-size: 24px;
                padding: 0.5em;
                background-color: grey;
            }
            div#itemListContainer {
                width: 80%;
            }
            div.itemContainer {
                display: flex;
                flex-direction: row;
            }
            div.item {
                border: 4px solid black;
                background-color: white;
                margin-top: -4px;
                margin-left: -4px;
                padding: 0.5em;
                font-size: 18px;
                
            }
            div.description {
                width: 30%;
            }
            div.type {
                width: 10%;
            }
            div.status {
                width: 15%;
            }
            div.additionalNotes {
                width: 25%;
            }
            div.photo {
                flex: 1;
            }
            button {
                background-color: black;
                color: white;
                font-size: 16px;
                border: 0;
            }
            button#menuButton {
                font-size: 24px;
                margin: 0.5em;
            }
            button:hover {
                background-color: rgb(23,23,23);
            }
            a.menuItem {
                color: white;
                font-size: 24px;
                padding: 0.5em;
                text-decoration: none;
                display: block;
            }
            a.menuItem:hover {
                background-color: rgb(23,23,23);
            }
        </style>
    </head>
    <body>
        <div id="dialogBox" aria-labelledby="menuButton">
            <div id="dialogBoxNavBar"><button id="closeMenuButton" aria-haspopup="true" aria-controls="dialogBox" aria-expanded="true">X</button></div>
            <a class="menuItem" href="submit.html">Submit an Item</a>
            <a class="menuItem" href="request.html">Submit a Request</a>
            <a class="menuItem" href="authors.html">Authors</a>
        </div>
        <div id="navigationBar">
        <button id="menuButton" aria-haspopup="true" aria-controls="dialogBox" aria-expanded="false">â‰£</button>
        <div id="title">NCSSM Security/Lost and Found</div>
        </div>
        <div id="mainContentContainer">
            <div id="itemListContainer">
                <div class="itemContainer">
                    <div class="item description">
                        Description
                    </div>
                    <div class="item type">
                        Type
                    </div>
                    <div class="item status">
                        Status
                    </div>
                    <div class="item additionalNotes">
                        Additional Notes
                    </div>
                    <div class="item photo">
                        Photo (if available)
                    </div>
                </div>
                <div class="itemContainer">
                    <div class="item description">
                        Green Gatorade Water Bottle
                    </div>
                    <div class="item type">
                        Water Bottle
                    </div>
                    <div class="item status">
                        Returned: --/--/--<br>
                        Claimed: --/--/--
                    </div>
                    <div class="item additionalNotes">
                        Located at Soccer Field
                    </div>
                    <div class="item photo">
                        No photo
                    </div>
                </div>
            </div>
        </div>
        <script type="text/javascript">
            async function init() {
                let params = new URLSearchParams(window.location.search)

                let userid = params.get('userid') || -1
                let uri = `/security/itemCatalog?userid=${userid}`

                let itemCatalog = await fetch(uri)
                itemCatalog = await itemCatalog.json()
                itemCatalog = itemCatalog.message

                for (let item of itemCatalog) {
                    let itemContainer = document.createElement('div')
                    itemContainer.classList.add('itemContainer')

                    let description = document.createElement('div')
                    description.classList.add('item', 'description')
                    description.textContent = item[0]
                    itemContainer.appendChild(description)

                    let objectType = document.createElement('div')
                    objectType.classList.add('item', 'type')
                    objectType.textContent = item[1]
                    itemContainer.appendChild(objectType)

                    let status = document.createElement('div')
                    status.classList.add('item', 'status')
                    status.innerHTML = "Returned: --/--/--<br>Claimed: --/--/--"
                    itemContainer.appendChild(status)

                    let additionalNotes = document.createElement('div')
                    additionalNotes.classList.add('item', 'additionalNotes')
                    additionalNotes.textContent = item[2]
                    itemContainer.appendChild(additionalNotes)

                    let photo = document.createElement('div')
                    photo.classList.add('item', 'photo')
                    photo.textContent = item[3]
                    itemContainer.appendChild(photo)
                    
                    let itemListContainer = document.getElementById('itemListContainer')
                    itemListContainer.appendChild(itemContainer)
                }
                document.addEventListener('click', screenClick);
                document.getElementById('menuButton').addEventListener('click', buttonClick);
                document.getElementById('closeMenuButton').addEventListener('click', buttonClick);
            }

            function screenClick(event) {
                let menuButton = document.getElementById('menuButton');
                let closeMenuButton = document.getElementById('closeMenuButton');
                if (menuButton.getAttribute('aria-expanded') === 'true') {
                    let dialogBox = document.getElementById('dialogBox');
                    if (event.pageX > dialogBox.offsetWidth) {
                        dialogBox.style.display = 'none';
                        menuButton.setAttribute('aria-expanded', false)
                        closeMenuButton.setAttribute('aria-expanded', false)
                        menuButton.style.display = 'block';
                    }
                }
            }

            function buttonClick(event) {
                let button = event.target;
                let button2 = document.getElementById('menuButton');
                if (button === button2) {
                    button2 = document.getElementById('closeMenuButton');
                }
                let dialogBox = document.getElementById(button.getAttribute('aria-controls'))
                if (button.getAttribute('aria-expanded') === 'true') {
                    button.setAttribute('aria-expanded', false);
                    button2.setAttribute('aria-expanded', false);
                    dialogBox.style.display = 'none';
                }
                else {
                    button.setAttribute('aria-expanded', true);
                    button2.setAttribute('aria-expanded', true);
                    dialogBox.style.display = 'block';
                }
            }

            window.onload = init;
        </script>
    </body>
</html>